{% extends 'header.html.twig' %}

{% block title %}{{ habitat.nom }}{% endblock %}

{% block body %}
<div class="habitat-detail">
    <div class="hero-section">
        {% if habitat.images|length > 0 %}
            <img src="data:image/jpeg;base64,{{ habitat.images[0].imageData }}" alt="{{ habitat.nom }}" class="img-fluid">
        {% else %}
            <img src="{{ asset('assets/styles/images/default.jpg') }}" alt="{{ habitat.nom }}" class="img-fluid">
        {% endif %}
        <div class="hero-content">
            <h1>{{ habitat.nom }}</h1>
            <p>{{ habitat.description }}</p>
        </div>
    </div>
    <h2>Animaux présents dans cet habitat :</h2>
    {% if animaux is not empty %}
        <div class="animals">
            {% for animal in animaux %}
                <div class="animal-card">
                    <img src="{{ asset(animal.getImagePath()) }}" alt="{{ animal.prenom }}" class="animal-image">
                    <h3>{{ animal.prenom }}</h3>
                    <p>{{ animal.getRaceName() }}</p>
                    <p>{{ animal.getEtat() }}</p>
                    {% if is_granted('ROLE_ADMIN') %}
                        <div class="d-flex justify-content-between mt-2">
                            <a href="?update={{ animal.animalId }}" class="btn btn-warning">Modifier</a>
                            <form action="?delete={{ animal.animalId }}" method="POST" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cet animal ?');">
                                <button type="submit" class="btn btn-danger">Supprimer</button>
                            </form>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>Aucun animal dans cet habitat.</p>
    {% endif %}
</div>

{% if is_granted('ROLE_ADMIN') %}
    <div class="form-container">
        {% if animalUpdateId %}
            <h3>Modifier un Animal</h3>
        {% else %}
            <h3>Créer un Animal</h3>
        {% endif %}
        {{ form_start(animalType, {'attr': {'enctype': 'multipart/form-data'}}) }}
            {{ form_widget(animalType) }}
            <button type="submit" name="{{ animalUpdateId ? 'update' : 'create' }}">
                {{ animalUpdateId ? 'Mettre à Jour' : 'Créer l\'animal' }}
            </button>
        {{ form_end(animalType) }}
    </div>
{% endif %}
{% endblock %}
